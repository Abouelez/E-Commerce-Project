<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Add Product - Admin Dashboard</title>
  <link rel="stylesheet" href="/css/admin-styles.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="/js/components.js"></script>
</head>
<body>
  <!-- Include header component -->
  <div data-include="/components/header.html"></div>

  <div class="admin-container">
    <!-- Include sidebar component -->
    <div data-include="/components/sidebar.html"></div>

    <!-- Main content area -->
    <main class="admin-content">
      <div class="page-header">
        <div class="page-title">
          <h2>Add Product</h2>
        </div>
      </div>

      <div class="content-card">
        <div class="add-product-form">
          <div class="product-image-upload">
            <div class="image-preview">
              <img id="product-image-preview" src="/assets/image-placeholder.jpg" alt="Product Image">
              <button class="edit-image-btn"><i class="fas fa-edit"></i></button>
            </div>
            <input type="file" id="product-image" accept="image/png, image/jpeg, image/jpg" style="display: none;">
            <p class="image-hint">Allowed file types: png, jpg, jpeg and cannot be more than 2 MB</p>
          </div>

          <div class="form-content">
            <!-- input conatiner -->
          <div class="input-container">
            <div class="form-row">
              <div class="form-group full-width">
                <label for="product-name">Name</label>
                <input type="text" id="product-name" placeholder="Enter product name">
              </div>
            </div>
  
            <div class="form-row">
              <div class="form-group">
                <label for="product-price">Price</label>
                <input type="number" id="product-price" placeholder="Enter price" min="0" step="0.01">
              </div>
            </div>
  
            <div class="form-row">
              <div class="form-group">
                <label for="product-category">Category</label>
                <div class="select-wrapper">
                  <select id="product-category">
                    <option value="" disabled selected>Select category</option>
                    <option value="Electronics">Electronics</option>
                    <option value="Clothing">Clothing</option>
                    <option value="Books">Books</option>
                    <option value="Home">Home</option>
                    <option value="Gaming">Gaming</option>
                  </select>
                  <i class="fas fa-chevron-down"></i>
                </div>
              </div>
            </div>
  
            <div class="form-row">
              <div class="form-group full-width">
                <label for="product-seller">Seller</label>
                <div class="select-wrapper">
                  <select id="product-seller">
                    <option value="" disabled selected>Select seller</option>
                    <option value="1">Seller User</option>
                    <option value="2">Another Seller</option>
                  </select>
                  <i class="fas fa-chevron-down"></i>
                </div>
              </div>
            </div>
          </div>
          <!-- end of input container -->

          <!-- start of discription box -->
          <div class="Discription-box">
            <div class="form-group full-width">
              <label>Description</label>
              <div class="rich-text-editor">
                <div class="editor-toolbar">
                  <div class="toolbar-group">
                    <button class="toolbar-btn"><i class="fas fa-undo"></i></button>
                    <button class="toolbar-btn"><i class="fas fa-redo"></i></button>
                  </div>
                  <div class="toolbar-group">
                    <button class="toolbar-btn active"><i class="fas fa-bold"></i></button>
                    <button class="toolbar-btn"><i class="fas fa-italic"></i></button>
                  </div>
                  <div class="toolbar-group">
                    <button class="toolbar-btn"><i class="fas fa-list-ul"></i></button>
                    <button class="toolbar-btn"><i class="fas fa-list-ol"></i></button>
                    <button class="toolbar-btn"><i class="fas fa-indent"></i></button>
                    <button class="toolbar-btn"><i class="fas fa-outdent"></i></button>
                  </div>
                  <div class="toolbar-group">
                    <button class="toolbar-btn"><i class="fas fa-align-left"></i></button>
                    <button class="toolbar-btn"><i class="fas fa-align-center"></i></button>
                    <button class="toolbar-btn"><i class="fas fa-align-right"></i></button>
                    <button class="toolbar-btn"><i class="fas fa-align-justify"></i></button>
                  </div>
                </div>
                <div class="editor-content" contenteditable="true" id="product-description"></div>
              </div>
            </div>
          </div>
          <!-- end of discription box -->
          </div>
          <div class="form-actions">
            <button class="btn-cancel">Cancel</button>
            <button class="btn-save">Save</button>
          </div>
        </div>
      </div>
    </main>
  </div>

  <script src="/js/admin.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Image upload preview
      const imageInput = document.getElementById('product-image');
      const imagePreview = document.getElementById('product-image-preview');
      const editImageBtn = document.querySelector('.edit-image-btn');
      
      editImageBtn.addEventListener('click', function() {
        imageInput.click();
      });
      
      imageInput.addEventListener('change', function() {
        if (this.files && this.files[0]) {
          const reader = new FileReader();
          
          reader.onload = function(e) {
            imagePreview.src = e.target.result;
          };
          
          reader.readAsDataURL(this.files[0]);
        }
      });
      
      // Form submission
      const saveBtn = document.querySelector('.btn-save');
      const cancelBtn = document.querySelector('.btn-cancel');
      
      saveBtn.addEventListener('click', function() {
        const name = document.getElementById('product-name').value;
        const price = document.getElementById('product-price').value;
        const category = document.getElementById('product-category').value;
        const seller = document.getElementById('product-seller').value;
        const description = document.getElementById('product-description').innerHTML;
        const isFeatured = document.getElementById('is-featured').checked;
        
        // Validate form
        if (!name || !price || !category || !seller) {
          alert('Please fill in all required fields');
          return;
        }
        
        // Create product object
        const product = {
          name,
          price: parseFloat(price),
          category,
          sellerId: parseInt(seller),
          description,
          isFeatured,
          status: 'pending'
        };
        
        // Send to server
        fetch('http://localhost:3000/products', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(product)
        })
        .then(response => {
          if (!response.ok) {
            throw new Error('Network response was not ok');
          }
          return response.json();
        })
        .then(data => {
          // Redirect to products page
          window.location.href = '/pages/admin/products.html';
        })
        .catch(error => {
          console.error('Error adding product:', error);
          alert('Error adding product. Please try again.');
        });
      });
      
      cancelBtn.addEventListener('click', function() {
        // Go back to products page
        window.location.href = '/pages/admin/products.html';
      });
    });
  </script>
</body>
</html>
